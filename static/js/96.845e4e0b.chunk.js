"use strict";(self.webpackChunkhcmd_communication=self.webpackChunkhcmd_communication||[]).push([[96],{3096:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{calculateByExpression:()=>calculateByExpression,default:()=>FormRenderer});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(99584),reactflow__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(80248),services_helper__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(66224),services_hooks_useDebounce__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(61415),_Builder_custom_components_inputs_ButtonNode__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(21488),_Builder_custom_components_inputs_CheckBoxNode__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(93976),_Builder_custom_components_inputs_DateTimeNode__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(65312),_Builder_custom_components_inputs_ImageNode__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(3836),_Builder_custom_components_inputs_LabelNode__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(57127),_Builder_custom_components_inputs_NumberNode__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(91152),_Builder_custom_components_inputs_PasswordNode__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(34408),_Builder_custom_components_inputs_RadioNode__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(89740),_Builder_custom_components_inputs_SelectNode__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(91092),_Builder_custom_components_inputs_SignatureNode__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(42100),_Builder_custom_components_inputs_TextAreaNode__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(75452),_Builder_custom_components_inputs_TextField__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(52592),_Builder_Services_NodeBuilder__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(41100),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(97884);function FormRenderer(_){let{onChange:e=(()=>{}),form:t,height:o,setSelectedNode:r=(()=>{}),rendered:n,nodeUpdateDelay:u=500}=_;const s=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),a=JSON.parse(localStorage.getItem("formNodes"))||[],[i,c,E]=(0,reactflow__WEBPACK_IMPORTED_MODULE_16__.wn)(t.components||a),[d,l]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),p=(0,services_hooks_useDebounce__WEBPACK_IMPORTED_MODULE_2__.c)(i,u);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{null!==p&&void 0!==p&&p.length&&localStorage.setItem("formNodes",JSON.stringify([])),e({components:p},t)}),[p,e]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const _=t.components&&t.components.map((_=>(0,_Builder_Services_NodeBuilder__WEBPACK_IMPORTED_MODULE_17__.Y)({id:_.id,type:_.type,position:_.position,nodeData:_.data})));c(_||a)}),[c]);const D=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((_=>{_.preventDefault(),_.dataTransfer.dropEffect="move"}),[]),m=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((_=>{_.preventDefault();const e=s.current.getBoundingClientRect(),t=_.dataTransfer.getData("application/reactflow");if("undefined"===typeof t||!t)return;const o=d.project({x:_.clientX-e.left,y:_.clientY-e.top});let r=(0,_Builder_Services_NodeBuilder__WEBPACK_IMPORTED_MODULE_17__.Y)({type:t,position:o});c((_=>[...null===_||void 0===_?void 0:_.map((_=>({..._,selected:!1})))].concat({...r,selected:!0})))}),[d,c]),O=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>({LabelNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_LabelNode__WEBPACK_IMPORTED_MODULE_7__.c,{..._,output:!0,rendered:n}),TextFieldNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_TextField__WEBPACK_IMPORTED_MODULE_14__.c,{..._,output:!0,rendered:n}),TextAreaNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_TextAreaNode__WEBPACK_IMPORTED_MODULE_13__.c,{..._,output:!0,rendered:n}),NumberNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_NumberNode__WEBPACK_IMPORTED_MODULE_8__.c,{..._,output:!0,rendered:n}),ButtonNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_ButtonNode__WEBPACK_IMPORTED_MODULE_3__.c,{..._,output:!0,rendered:n}),PasswordNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_PasswordNode__WEBPACK_IMPORTED_MODULE_9__.c,{..._,output:!0,rendered:n}),SelectNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_SelectNode__WEBPACK_IMPORTED_MODULE_11__.c,{..._,output:!0,rendered:n}),RadioNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_RadioNode__WEBPACK_IMPORTED_MODULE_10__.c,{..._,output:!0,rendered:n}),CheckBoxNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_CheckBoxNode__WEBPACK_IMPORTED_MODULE_4__.c,{..._,output:!0,rendered:n}),DateTimeNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_DateTimeNode__WEBPACK_IMPORTED_MODULE_5__.c,{..._,output:!0,rendered:n}),ImageNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_ImageNode__WEBPACK_IMPORTED_MODULE_6__.c,{..._,output:!0,rendered:n}),SignatureNode:_=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_Builder_custom_components_inputs_SignatureNode__WEBPACK_IMPORTED_MODULE_12__.c,{..._,output:!0,rendered:n})})),[n]),{pageHeight:M=0}=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>{let _={pageHeight:2e3};if(null!==p&&void 0!==p&&p.length){const e=Math.min(...p.map((_=>{var e;return null===(e=_.position)||void 0===e?void 0:e.y})))||2e3,t=Math.max(...p.map((_=>{var e;return null===(e=_.position)||void 0===e?void 0:e.y})))||2e3;_={pageHeight:Number((t-e).toFixed(0))+1e3}}return _}),[p]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)("div",{className:"hcmd-form-builder",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)("div",{className:"form-canvas dnddlow",style:{height:o||"85vh",maxWidth:1200},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)("div",{className:"reactflow-wrapper h-100 bg-light",ref:s,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(reactflow__WEBPACK_IMPORTED_MODULE_16__.UX,{nodes:i,onNodesChange:E,onInit:l,onDrop:m,onDragOver:D,style:{background:"#fff"},nodeTypes:O,defaultViewport:{x:0,y:0,zoom:1},nodesDraggable:!n,selectNodesOnDrag:!0,nodesFocusable:!0,draggable:!1,zoomOnScroll:!1,zoomOnPinch:!1,zoomOnDoubleClick:!1,panOnDrag:!1,panOnScroll:!0,panOnScrollMode:"free",selectionOnDrag:!0,onSelectionChange:_=>{let{nodes:e}=_;return r(e.length?e[0]:null)},translateExtent:[[0,0],[1200,M]]})})})})}const calculateByExpression=_ref3=>{let{expression:expression,nodes:nodes}=_ref3;const variableNames=[...new Set(expression.match(/[a-zA-Z_]+/g))];let modifiedExp=expression,isAnyNull=!1;if(null===variableNames||void 0===variableNames||!variableNames.length)return;let fieldNameValues=variableNames.map((_=>{var e;if(!_)return{name:_,value:""};const t=null===(e=nodes.find((e=>e.data.name===_)))||void 0===e?void 0:e.data;return t&&t.value?{name:_,value:t.value}:{name:_,value:""}}));for(const _ of variableNames){let e=fieldNameValues.find((e=>e.name===_)).value||"";e=e.trim(),modifiedExp=modifiedExp.replaceAll(_,(0,services_helper__WEBPACK_IMPORTED_MODULE_1__.Ir)(e)?"".concat(Number(e)||0):"'".concat(String(e)||"","'")),e||(isAnyNull=!0)}if(!isAnyNull){let value="".concat(eval(modifiedExp))||"";return(0,services_helper__WEBPACK_IMPORTED_MODULE_1__.Ir)(value)&&(value="".concat(Number(value).toFixed(0))),{value:value,isNull:isAnyNull}}return{isNull:isAnyNull}}}}]);