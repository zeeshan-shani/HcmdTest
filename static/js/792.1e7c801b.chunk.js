"use strict";(self.webpackChunkHcmdTest=self.webpackChunkHcmdTest||[]).push([[792],{86792:(e,t,l)=>{l.r(t),l.d(t,{default:()=>te});var o=l(99584),a=l(80248),n=l(88708),i=l(24888),s=l(89828),d=l(71608),r=l(45596),c=l(41360),p=l(87804),u=l(47104),m=l(96196),h=l(85936),f=l(38172),b=l(32915),y=l(90856),g=l(60292),x=l(52008),v=l(81728),j=l(11336),w=l(97884);const k=[{group:"Tools",fields:[{id:"cutfield",name:"CutNode",label:"Cut",action:"cut",icon:(0,w.jsx)(s.c,{})},{id:"copyfield",name:"CopyNode",label:"Copy",action:"copy",icon:(0,w.jsx)(d.c,{})},{id:"pastefield",name:"PasteNode",label:"Paste",action:"paste",icon:(0,w.jsx)(r.c,{})},{id:"cancelfield",name:"CancelNode",label:"Cancel",action:"cancel",icon:(0,w.jsx)(c.c,{})}]},{group:"Basic",fields:[{id:"labelfield",name:"LabelNode",label:"Text Label",icon:(0,w.jsx)(p.c,{})},{id:"textfield",name:"TextFieldNode",label:"Input Text",icon:(0,w.jsx)(b.c,{fontSize:22,fontWeight:"bold"})},{id:"textarea",name:"TextAreaNode",label:"Textarea",icon:(0,w.jsx)(y.c,{fontSize:22,fontWeight:"bold"})},{id:"checkbox",name:"CheckBoxNode",label:"Checkbox",icon:(0,w.jsx)(g.c,{fontSize:22,fontWeight:"bold"})},{id:"select",name:"SelectNode",label:"Select",icon:(0,w.jsx)(x.c,{fontSize:22,fontWeight:"bold"})},{id:"radio",name:"RadioNode",label:"Radio",icon:(0,w.jsx)(v.c,{fontSize:22,fontWeight:"bold"})},{id:"image",name:"ImageNode",label:"Image",icon:(0,w.jsx)(h.c,{})},{id:"button",name:"ButtonNode",label:"Button",icon:(0,w.jsx)(m.c,{})}]},{group:"Advance",fields:[{id:"dateTimeField",name:"DateTimeNode",label:"Date / Time",icon:(0,w.jsx)(j.c,{fontSize:22,fontWeight:"bold"})},{id:"signatureField",name:"SignatureNode",label:"Signature",icon:(0,w.jsx)(u.c,{})}]}];function N(e){let{onCopyNode:t,onPasteNode:l,onCutNode:a,onCancelNode:n}=e;const i=(0,o.useCallback)(((e,t)=>{e.dataTransfer.setData("application/reactflow",t),e.dataTransfer.effectAllowed="move"}),[]),s=(0,o.useCallback)((e=>{"copy"===e.action?t(e):"cut"===e.action?a(e):"paste"===e.action?l(e):n(e)}),[t,l,a,n]);return(0,w.jsx)("div",{className:"btn-toolbar mb-2",role:"toolbar","aria-label":"Toolbar with button groups",children:k.map(((e,t)=>(0,w.jsx)("div",{className:"btn-group mr-2 mb-2",role:"group","aria-label":"First group",children:e.fields.map(((t,l)=>(0,w.jsx)(f.a2,{title:t.label,children:(0,w.jsx)("button",{className:"btn btn-secondary formcomponent drag-copy",onDragStart:e=>i(e,t.name),draggable:"Tools"!==e.group,onClick:()=>{"Tools"===e.group&&s(t)},children:null===t||void 0===t?void 0:t.icon},l)},l)))},t)))})}var C=l(41100),F=l(61415),_=l(75452),D=l(52592),I=l(91152),S=l(57127),T=l(21488),O=l(34408),L=l(91092),E=l(89740),R=l(93976),B=l(65312),P=l(42100),M=l(3836),H=l(21664),A=l(33688),V=l(75448),W=l(83664),q=l(75672);function Y(e){let{component:t}=e;return(0,w.jsx)("div",{children:"GenerateField"})}const z={type:"tabs",key:"tabs",components:[{label:"Display",key:"display",weight:0,components:[{weight:100,type:"textfield",input:!0,key:"placeholder",label:"Placeholder",placeholder:"Placeholder",tooltip:"The placeholder text that will appear when this field is empty."},{weight:200,type:"textarea",input:!0,key:"description",label:"Description",placeholder:"Description for this field.",tooltip:"The description is text that will appear below the input field."},{weight:300,type:"checkbox",label:"Disabled",tooltip:"Disable the form input.",key:"disabled",input:!0}]},{label:"Data",key:"data",weight:10,components:[{type:"textfield",label:"Default Value",key:"defaultValue",weight:5,placeholder:"Default Value",tooltip:"The Default Value will be the value for this field, before user interaction. Having a default value will override the placeholder text.",input:!0},{weight:150,type:"checkbox",label:"Protected",tooltip:"A protected field will not be returned when queried via API.",key:"protected",input:!0},{type:"select",input:!0,key:"redrawOn",label:"Redraw On",weight:600,tooltip:"Redraw this component if another component changes. This is useful if interpolating parts of the component like the label.",dataSrc:"custom",valueProperty:"value",data:{custom(e){var t=[];return t.push({label:"Any Change",value:"data"}),e.utils.eachComponent(e.instance.options.editForm.components,(function(l,o){l.key!==e.data.key&&t.push({label:l.label||l.key,value:o})})),t}},conditional:{json:{"!":[{var:"data.dataSrc"}]}}},{weight:700,type:"checkbox",label:"Clear Value When Hidden",key:"clearOnHide",defaultValue:!0,tooltip:"When a field is hidden, clear the value.",input:!0},{type:"checkbox",input:!0,weight:1200,key:"allowCalculateOverride",label:"Allow Manual Override of Calculated Value",tooltip:"When checked, this will allow the user to manually override the calculated value."}]},{label:"Validation",key:"validation",weight:20,components:[{weight:10,type:"checkbox",label:"Required",tooltip:"A required field must be filled in before the form can be submitted.",key:"validate.required",input:!0},{weight:200,key:"validate.customMessage",label:"Custom Error Message",placeholder:"Custom Error Message",type:"textfield",tooltip:"Error message displayed if any error occurred.",input:!0},{type:"panel",title:"Custom Validation",collapsible:!0,collapsed:!0,style:{"margin-bottom":"10px"},key:"custom-validation-js",weight:300,components:[{type:"textarea",key:"validate.custom",rows:5,editor:"ace",hideLabel:!0,as:"javascript",input:!0},{type:"htmlelement",tag:"div",content:"\n          <small>\n            <p>Enter custom validation code.</p>\n            <p>You must assign the <strong>valid</strong> variable as either <strong>true</strong> or an error message if validation fails.</p>\n            <h5>Example:</h5>\n            <pre>valid = (input === 'Joe') ? true : 'Your name must be \"Joe\"';</pre>\n          </small>"},{type:"well",components:[{weight:100,type:"checkbox",label:"Secret Validation",tooltip:"Check this if you wish to perform the validation ONLY on the server side. This keeps your validation logic private and secret.",description:"Check this if you wish to perform the validation ONLY on the server side. This keeps your validation logic private and secret.",key:"validate.customPrivate",input:!0}]}]},{type:"panel",title:"JSONLogic Validation",collapsible:!0,collapsed:!0,key:"json-validation-json",weight:400,components:[{type:"htmlelement",tag:"div",content:'<p>Execute custom logic using <a href="http://jsonlogic.com/" target="_blank" rel="noopener noreferrer">JSONLogic</a>.</p><h5>Example:</h5><pre>'+JSON.stringify({if:[{"===":[{var:"input"},"Bob"]},!0,"Your name must be 'Bob'!"]},null,2)+"</pre>"},{type:"textarea",key:"validate.json",hideLabel:!0,rows:5,editor:"ace",as:"json",input:!0}]},{type:"panel",title:"Custom Errors",collapsible:!0,collapsed:!0,key:"errors",weight:400,components:[{type:"textarea",key:"errors",hideLabel:!0,rows:5,editor:"ace",as:"json",input:!0},{type:"htmlelement",tag:"div",content:'\n          <p>This allows you to set different custom error messages for different errors\n          (in contrast to \u201cCustom Error Message\u201d, which only allows you to set one\n          error message for all errors). E.g.</p>\n\n<pre>{\n  "required": "{<span/>{ field }} is required. Try again.",\n  "maxLength": "{<span/>{ field }} is too long. Try again."\n}</pre>\n\n          <p>You can set the following keys (among others):</p>\n          <ul>\n            <li>r<span/>equired</li>\n            <li>m<span/>in</li>\n            <li>m<span/>ax</li>\n            <li>m<span/>inLength</li>\n            <li>m<span/>axLength</li>\n            <li>m<span/>inWords</li>\n            <li>m<span/>axWords</li>\n            <li>i<span/>nvalid_email</li>\n            <li>i<span/>nvalid_date</li>\n            <li>i<span/>nvalid_day</li>\n            <li>i<span/>nvalid_regex</li>\n            <li>m<span/>ask</li>\n            <li>p<span/>attern</li>\n            <li>c<span/>ustom</li>\n          </ul>\n\n          <p>Depending on the error message some of the following template variables can be used in the script:</p>\n          <ul>\n           <li><code>{<span/>{ f<span/>ield }}</code> is replaced with the label of the field.</li>\n           <li><code>{<span/>{ m<span/>in }}</code></li>\n           <li><code>{<span/>{ m<span/>ax }}</code></li>\n           <li><code>{<span/>{ l<span/>ength }}</code></li>\n           <li><code>{<span/>{ p<span/>attern }}</code></li>\n           <li><code>{<span/>{ m<span/>inDate }}</code></li>\n           <li><code>{<span/>{ m<span/>axDate }}</code></li>\n           <li><code>{<span/>{ m<span/>inYear }}</code></li>\n           <li><code>{<span/>{ m<span/>axYear }}</code></li>\n           <li><code>{<span/>{ r<span/>egex }}</code></li>\n          </ul>\n        '}]}]},{label:"Conditional",key:"conditional",weight:40,components:[{type:"panel",title:"Simple",key:"simple-conditional",theme:"default",weight:105,components:[{type:"select",input:!0,label:"This component should Display:",key:"conditional.show",dataSrc:"values",data:{values:[{label:"True",value:"true"},{label:"False",value:"false"}]}},{type:"select",input:!0,label:"When the form component:",key:"conditional.when",dataSrc:"custom",valueProperty:"value",data:{}},{type:"textfield",input:!0,label:"Has the value:",key:"conditional.eq"}]}]}]};function J(e){let{editField:t}=e;const[l,a]=(0,o.useState)("display"),n=(0,o.useMemo)((()=>{var e;return(0,w.jsxs)(A.c,{children:[(0,w.jsx)(A.c.Header,{className:"pb-0 px-0",children:(0,w.jsx)("nav",{className:"task-nav",children:(0,w.jsx)("div",{className:"nav nav-tabs px-2",id:"nav-tab",role:"tablist",children:z.components.map((e=>(0,w.jsx)("button",{className:"nav-link ".concat(e.key===l?"active":""),type:"button",role:"tab",onClick:()=>a(e.key),children:e.label})))})})}),(0,w.jsx)(A.c.Body,{children:null===(e=z.components.find((e=>e.key===l)))||void 0===e?void 0:e.components.map((e=>(0,w.jsx)(Y,{component:e})))})]})}),[l]),i=(0,o.useMemo)((()=>(0,w.jsxs)("div",{children:[(0,w.jsxs)(A.c,{children:[(0,w.jsx)(A.c.Header,{children:(0,w.jsx)("h5",{className:"mb-0",children:"Preview"})}),(0,w.jsx)(A.c.Body,{})]}),(0,w.jsxs)("div",{className:"buttons d-flex gap-10 my-2",children:[(0,w.jsx)(V.c,{variant:"success",children:"Save"}),(0,w.jsx)(V.c,{variant:"secondary",children:"Cancel"}),(0,w.jsx)(V.c,{variant:"danger",children:"Remove"})]})]})),[]);return(0,w.jsxs)(W.c,{children:[(0,w.jsx)(q.c,{sm:12,md:6,children:n}),(0,w.jsx)(q.c,{sm:12,md:6,children:i})]})}const U=function(){return{modalHeader:"Input Component",...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}};function X(e){let{editingInputField:t,setInputField:l}=e;const a=(0,o.useMemo)((()=>null!==t&&void 0!==t&&t.type?G(t):null),[t]);return(0,w.jsx)(H.c,{show:t,onHide:()=>l(),dialogClassName:"width-85vw","aria-labelledby":t&&"".concat(t.id,"-").concat(t.type),children:t&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(H.c.Header,{closeButton:!0,children:(0,w.jsx)(H.c.Title,{id:"".concat(t.id,"-").concat(t.type),children:null===a||void 0===a?void 0:a.modalHeader})}),(0,w.jsx)(H.c.Body,{children:(0,w.jsx)(J,{editField:t})})]})})}const G=e=>{let{type:t}=e;return"TextFieldNode"===t?U({modalHeader:"Text Field Component"}):U()};var Z=l(81296),K=l(86536),Q=l(25324),$=l(20076),ee=l(84920);function te(e){let{onChange:t,form:l,setState:s}=e;const d=(0,o.useRef)(null),{form_builder_field:r}=(0,$.w1)((e=>e.model)),c=JSON.parse(localStorage.getItem("formNodes"))||[],[p,u,m]=(0,a.wn)((null===l||void 0===l?void 0:l.components)||c),[h,f]=(0,o.useState)(null),[b,y]=(0,o.useState)(),[g,x]=(0,o.useState)(),v=(0,F.c)(p,500);(0,o.useEffect)((()=>{null!==v&&void 0!==v&&v.length&&localStorage.setItem("formNodes",JSON.stringify([])),t({components:v})}),[v,t]),(0,o.useEffect)((()=>{const e=(null===l||void 0===l?void 0:l.components)&&l.components.map((e=>(0,C.Y)({id:e.id,type:e.type,position:e.position,output:e.output,nodeData:e.data,style:e.style})));u(e||c)}),[u]);const j=(0,o.useCallback)((e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"}),[]),k=(0,o.useCallback)((e=>{e.preventDefault();const t=d.current.getBoundingClientRect(),l=e.dataTransfer.getData("application/reactflow");if("undefined"===typeof l||!l)return;const o=h.project({x:e.clientX-t.left,y:e.clientY-t.top});let a=(0,C.Y)({type:l,position:o});u((e=>[...null===e||void 0===e?void 0:e.map((e=>({...e,selected:!1})))].concat({...a,selected:!0})))}),[h,u]),H=(0,o.useCallback)((async()=>{if(!g)return(0,ee.u)("Please select item to copy",{id:"form_builder_error"});(0,K.qg)({type:Q.w.FORM_BUILDER_CLIPBOARD_FIELD,payload:{form_builder_field:g}}),(0,ee.I)("Field Copied to board",{id:"form_builder_copy"})}),[g]),A=(0,o.useCallback)((()=>{if(!r)return(0,ee.u)("No item found on board",{id:"form_builder_error"});let e=r;e.id="dndnode_".concat(Date.now()),e.name="",e.position={x:r.position.x+25,y:r.position.y-25},e.selected=!1,e.positionAbsolute=e.position,u((t=>[...t,e])),(0,K.qg)({type:Q.w.FORM_BUILDER_CLIPBOARD_FIELD,payload:{form_builder_field:null}}),(0,ee.I)("Field Pasted to board",{id:"form_builder_paste"})}),[r,u]),V=(0,o.useCallback)((async()=>{if(!g)return(0,ee.u)("Please select item to cut",{id:"form_builder_error"});(0,K.qg)({type:Q.w.FORM_BUILDER_CLIPBOARD_FIELD,payload:{form_builder_field:g}}),(0,ee.I)("Field Cut from board",{id:"form_builder_cut"}),u((e=>e.filter((e=>e.id!==g.id))))}),[g,u]),Y=(0,o.useCallback)((()=>{r&&(x(),(0,K.qg)({type:Q.w.FORM_BUILDER_CLIPBOARD_FIELD,payload:{form_builder_field:null}}),(0,ee.I)("Field Removed",{id:"form_builder_cancel"}))}),[r]),z=(0,o.useMemo)((()=>({LabelNode:e=>(0,w.jsx)(S.c,{...e,setInputField:y}),TextFieldNode:e=>(0,w.jsx)(D.c,{...e,setInputField:y}),TextAreaNode:e=>(0,w.jsx)(_.c,{...e,setInputField:y}),NumberNode:e=>(0,w.jsx)(I.c,{...e,setInputField:y}),ButtonNode:e=>(0,w.jsx)(T.c,{...e,setInputField:y}),PasswordNode:e=>(0,w.jsx)(O.c,{...e,setInputField:y}),SelectNode:e=>(0,w.jsx)(L.c,{...e,setInputField:y}),RadioNode:e=>(0,w.jsx)(E.c,{...e,setInputField:y}),CheckBoxNode:e=>(0,w.jsx)(R.c,{...e,setInputField:y}),DateTimeNode:e=>(0,w.jsx)(B.c,{...e,setInputField:y}),SignatureNode:e=>(0,w.jsx)(P.c,{...e,setInputField:y}),ImageNode:e=>(0,w.jsx)(M.c,{...e,setInputField:y})})),[]),{pageHeight:J=0}=(0,o.useMemo)((()=>{let e={pageHeight:2e3};if(null!==v&&void 0!==v&&v.length){const t=Math.min(...v.map((e=>e.position.y)))||2e3,l=Math.max(...v.map((e=>e.position.y)))||2e3;e={pageHeight:Number((l-t).toFixed(0))+1e3}}return e}),[v]);return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)("div",{className:"hcmd-form-builder",children:[(0,w.jsx)(N,{onCopyNode:H,onPasteNode:A,onCutNode:V,onCancelNode:Y}),(0,w.jsx)(a.Mt,{children:(0,w.jsxs)(W.c,{children:[(0,w.jsx)(q.c,{md:8,className:"d-flex justify-content-center",children:(0,w.jsx)("div",{className:"form-canvas dndflow",style:{height:"85vh",maxWidth:1200},children:(0,w.jsx)("div",{className:"reactflow-wrapper",ref:d,children:(0,w.jsxs)(a.UX,{nodes:p.filter((e=>{var t,l;return!(null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&null!==(l=t.onlyOutput)&&void 0!==l&&l.length)})),onNodesChange:m,onInit:f,onDrop:k,onDragOver:j,nodeTypes:z,defaultViewport:{x:0,y:0,zoom:1},selectNodesOnDrag:!0,draggable:!1,zoomOnScroll:!1,zoomOnPinch:!1,zoomOnDoubleClick:!1,panOnDrag:!1,panOnScroll:!0,panOnScrollMode:"free",selectionOnDrag:!0,onSelectionChange:e=>{let{nodes:t}=e;return x(t.length?t[0]:null)},style:{background:"#fff"},translateExtent:[[0,0],[1200,J]],children:[(0,w.jsx)(n.O,{showZoom:!1,showFitView:!1}),(0,w.jsx)(i.y,{color:"#aaa",gap:16})]})})})}),(0,w.jsx)(q.c,{md:4,children:(0,w.jsx)(Z.c,{field:g,setField:x,setNodes:u,setState:s},null===g||void 0===g?void 0:g.id)})]})}),(0,w.jsx)(X,{editingInputField:b,setInputField:y})]})})}}}]);